const s=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const m=window.enmity.modules.common.Toasts,F=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const C=window.enmity.modules.common.Navigation,$=window.enmity.modules.common.NavigationNative,P=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const p=window.enmity.modules.common.Linking,I=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function V(e){window.enmity.plugins.registerPlugin(e)}const M={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,t)=>window.enmity.modules.filters.byName(e,t),byTypeName:(e,t)=>window.enmity.modules.filters.byTypeName(e,t),byDisplayName:(e,t)=>window.enmity.modules.filters.byDisplayName(e,t)};function X(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert;const q=o.Button;o.FlatList;const _=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const v=o.Text,A=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const b=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox,o.FormDivider,o.FormHint,o.FormIcon;const J=o.FormInput;o.FormLabel,o.FormRadio;const R=o.FormRow,K=o.FormSection;o.FormSelect,o.FormSubLabel;const Q=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function k(e,t,i){window.enmity.settings.set(e,t,i)}function h(e,t,i){return window.enmity.settings.get(e,t,i)}function Z(e){return window.enmity.patcher.create(e)}function g(e){return window.enmity.assets.getIDByName(e)}function L(e,t){let i="";for(let a=0;a<e.length;a++)i+=String.fromCharCode(e.charCodeAt(a)^t.charCodeAt(a%t.length));return i}const D="Love K2ge3 lol",ee=g("img_nitro_star"),oe=g("Small");var te=({settings:e})=>{const t=I.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:50,height:50,marginTop:20,marginLeft:20},description:{flex:1,fontSize:30,paddingTop:20,paddingLeft:40,color:s.ThemeColorMap.HEADER_SECONDARY},info:{height:35,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"}});return n.createElement(b,null,n.createElement(b,{style:t.container},n.createElement(_,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:t.image}),n.createElement(v,{style:t.description},"K2geLocker")),n.createElement(K,{title:"SETTINGS"},n.createElement(J,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:i=>{if(i.nativeEvent.text=="")m.open({content:"Please enter your custom passcode",source:oe});else{let a=L(i.nativeEvent.text,`${D[5]}${D[6]}${D[0]}`);e.set("passcode",a),m.open({content:"Successfully set new passcode!",source:ee})}},secureTextEntry:!0}),n.createElement(R,{label:"Enable invitation menu hijacking",trailing:n.createElement(Q,{value:e.getBoolean("inv_hijack",!0),onValueChange:i=>{e.set("inv_hijack",i)}})})),n.createElement(K,{title:"INFORMATION"},n.createElement(R,{label:"GitHub",style:t.info,trailing:R.Arrow,onPress:()=>{p.openURL("https://github.com/m4fn3/K2geLocker")}}),n.createElement(R,{label:"Twitter",style:t.info,trailing:R.Arrow,onPress:()=>{p.openURL("https://twitter.com/m4fn3")}})))},Y;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(Y||(Y={}));var T;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(T||(T={}));var G;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(G||(G={}));var H;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(H||(H={}));var U;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(U||(U={}));var z;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(z||(z={}));const ne=g("img_nitro_star"),re=g("Small"),se={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:T.Chat,execute:async function(e,t){h("K2geLocker","passcode")===void 0?m.open({content:"Please set passcode in plugin setting before you lock the server!",source:re}):(k("K2geLocker",t.guild.id,!0),m.open({content:"Successfully locked!",source:ne}))}},j=P.createStackNavigator(),x="Love K2ge3 lol",ie=g("nsfw_gate_lock"),le=g("img_nitro_star"),ce=g("Small");var O=({guildId:e,fn:t})=>{function i(){const l=I.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(b,{style:l.container},n.createElement(_,{style:l.image,source:ie}),n.createElement(v,{style:l.header},"This server is locked!"),n.createElement(v,{style:l.text},"enter passcode to unlock"),n.createElement(A,{style:l.passcode,onSubmitEditing:d=>{d.nativeEvent.text==L(h("K2geLocker","passcode"),`${x[5]}${x[6]}${x[0]}`)?(k("K2geLocker",e,!1),t(),m.open({content:"Successfully unlocked!",source:le}),C.pop()):m.open({content:"Incorrect password. Try again.",source:ce})},secureTextEntry:!0}),n.createElement(v,{style:l.footer},"K2geLocker"))}const a=I.createThemedStyleSheet({container:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:s.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:s.ThemeColorMap.HEADER_PRIMARY},close:{color:s.ThemeColorMap.HEADER_PRIMARY}});return n.createElement($.NavigationContainer,null,n.createElement(j.Navigator,{initialRouteName:"K2egeLocker",style:a.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:a.cardStyle,headerStyle:a.header,headerTitleContainerStyle:a.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},n.createElement(j.Screen,{name:"K2geLocker",component:i,options:{headerTitleStyle:{color:"white"},headerLeft:()=>n.createElement(q,{color:a.close.color,title:"Close",onPress:()=>C.pop()}),...P.TransitionPresets.ModalSlideFromBottomIOS}})))};function W(e,t,i){return window.enmity.utilities.findInReactTree(e,t,i)}const S=Z("K2geLocker"),[ae,me,de,ue]=X(M.byName("MessagesConnected",!1),M.byProps("openLazy","hideActionSheet"),M.byName("GuildTooltipActionSheets",!1),M.byName("GuildsConnected",!1)),he=g("nsfw_gate_lock"),B=g("img_nitro_star"),N=g("Small"),ge=g("ic_locked_24px"),we=g("ic_full_server_gating_24px"),ye={name:"K2geLocker",version:"1.1.0",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[se];let e=()=>{},t="0",i=this.name;h(this.name,"inv_hijack")===void 0&&k(this.name,"inv_hijack",!0),S.after(ue,"default",(l,d,w)=>{S.after(w,"type",(y,f,c)=>{e=c.handleGuildFolderExpand})});const a=S.after(b,"render",(l,d,w)=>{const y=W(w,c=>{var r,u,E;return((r=c.props)==null?void 0:r.delayLongPress)==300&&((u=c.props)==null?void 0:u.onGuildSelected)===void 0&&((E=c.props)==null?void 0:E.guild)});if(y){S.before(y.type,"type",(c,r,u)=>{h(this.name,r[0].guild.id)?r[0].onGuildSelected=E=>{C.push(O,{guildId:E,fn:e})}:r[0].onGuildSelected=void 0});return}const f=W(w,c=>{var r,u,E;return((r=c.props)==null?void 0:r.guildId)&&((u=c.props)==null?void 0:u.yPos)&&((E=c.props)==null?void 0:E.onClose)});!f||(S.after(f.type,"render",(c,r,u)=>(h(this.name,r[0].guildId)?u.props.rows=[{icon:we,text:"Unlock Server",onClick:()=>{C.push(O,{guildId:r[0].guildId,fn:e})}}]:u.props.rows.unshift({icon:ge,text:"Lock Server",onClick:()=>{h(this.name,"passcode")===void 0?m.open({content:"Please set passcode in plugin setting before you lock the server!",source:N}):h(this.name,r[0].guildId)?m.open({content:"This server is already locked!",source:N}):(k(this.name,r[0].guildId,!0),e(),m.open({content:"Successfully locked!",source:B}))}}),u)),a())});S.instead(de,"default",(l,d,w)=>(t=d[0].guildId,w.apply(l,d))),S.instead(ae,"default",(l,d,w)=>{var y;let f=w.apply(l,d),c=(y=f==null?void 0:f.props)==null?void 0:y.guildId;if(c&&h(this.name,c)){const r=I.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:200,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(b,{style:r.container},n.createElement(_,{style:r.image,source:he}),n.createElement(v,{style:r.header},"This server is locked!"),n.createElement(v,{style:r.text},"enter passcode to unlock"),n.createElement(A,{style:r.passcode,onSubmitEditing:u=>{u.nativeEvent.text==L(h(this.name,"passcode"),`${i[0]}${i[1]}${i[4]}`)?(k(this.name,c,!1),m.open({content:"Successfully unlocked!",source:B})):m.open({content:"Incorrect password. Try again.",source:N})},secureTextEntry:!0}),n.createElement(v,{style:r.footer},"K2geLocker"))}else return f}),S.instead(me,"openLazy",(l,d,w)=>{let y=d[1];(y.startsWith("instant-invite")||y.startsWith("vanity-url-invite"))&&h(this.name,"inv_hijack")?h(this.name,t)?F.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):F.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{h(this.name,"passcode")===void 0?m.open({content:"Please set passcode in plugin setting before you lock the server!",source:N}):(k(this.name,t,!0),m.open({content:"Successfully locked!",source:B}))},onCancel:()=>{w.apply(l,d)}}):w.apply(l,d)})},onStop(){this.commands=[],S.unpatchAll()},getSettingsPanel({settings:e}){return n.createElement(te,{settings:e})}};V(ye);
