const s=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const a=window.enmity.modules.common.Toasts,F=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const R=window.enmity.modules.common.Navigation,W=window.enmity.modules.common.NavigationNative,P=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const K=window.enmity.modules.common.Linking,N=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function V(e){window.enmity.plugins.registerPlugin(e)}const C={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,t)=>window.enmity.modules.filters.byName(e,t),byTypeName:(e,t)=>window.enmity.modules.filters.byTypeName(e,t),byDisplayName:(e,t)=>window.enmity.modules.filters.byDisplayName(e,t)};function X(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert;const q=o.Button;o.FlatList;const _=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const v=o.Text,A=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const M=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox,o.FormDivider,o.FormHint,o.FormIcon;const J=o.FormInput;o.FormLabel,o.FormRadio;const b=o.FormRow,Y=o.FormSection;o.FormSelect,o.FormSubLabel;const Q=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function k(e,t,i){window.enmity.settings.set(e,t,i)}function h(e,t,i){return window.enmity.settings.get(e,t,i)}function Z(e){return window.enmity.patcher.create(e)}function g(e){return window.enmity.assets.getIDByName(e)}function L(e,t){let i="";for(let m=0;m<e.length;m++)i+=String.fromCharCode(e.charCodeAt(m)^t.charCodeAt(m%t.length));return i}const D="Love K2ge3 lol",ee=g("img_nitro_star"),oe=g("Small");var te=({settings:e})=>n.createElement(M,null,n.createElement(_,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:{width:50,height:50,marginTop:20,marginLeft:20}}),n.createElement(Y,{title:"SETTINGS"},n.createElement(J,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:t=>{if(t.nativeEvent.text=="")a.open({content:"Please enter your custom passcode",source:oe});else{let i=L(t.nativeEvent.text,`${D[5]}${D[6]}${D[0]}`);e.set("passcode",i),a.open({content:"Successfully set new passcode!",source:ee})}},secureTextEntry:!0}),n.createElement(b,{label:"Enable invitation menu hijacking",trailing:n.createElement(Q,{value:e.getBoolean("inv_hijack",!0),onValueChange:t=>{e.set("inv_hijack",t)}})})),n.createElement(Y,{title:"INFORMATION"},n.createElement(b,{label:"GitHub",trailing:b.Arrow,onPress:()=>{K.openURL("https://github.com/m4fn3/K2geLocker")}}),n.createElement(b,{label:"Twitter",trailing:b.Arrow,onPress:()=>{K.openURL("https://twitter.com/m4fn3")}}))),G;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(G||(G={}));var B;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(B||(B={}));var H;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(H||(H={}));var U;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(U||(U={}));var p;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(p||(p={}));var $;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})($||($={}));const ne=g("img_nitro_star"),re=g("Small"),se={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:B.Chat,execute:async function(e,t){h("K2geLocker","passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:re}):(k("K2geLocker",t.guild.id,!0),a.open({content:"Successfully locked!",source:ne}))}},z=P.createStackNavigator(),T="Love K2ge3 lol",ie=g("nsfw_gate_lock"),le=g("img_nitro_star"),ce=g("Small");var O=({guildId:e,fn:t})=>{function i(){const l=N.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(M,{style:l.container},n.createElement(_,{style:l.image,source:ie}),n.createElement(v,{style:l.header},"This server is locked!"),n.createElement(v,{style:l.text},"enter passcode to unlock"),n.createElement(A,{style:l.passcode,onSubmitEditing:d=>{d.nativeEvent.text==L(h("K2geLocker","passcode"),`${T[5]}${T[6]}${T[0]}`)?(k("K2geLocker",e,!1),t(),a.open({content:"Successfully unlocked!",source:le}),R.pop()):a.open({content:"Incorrect password. Try again.",source:ce})},secureTextEntry:!0}),n.createElement(v,{style:l.footer},"K2geLocker"))}const m=N.createThemedStyleSheet({container:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:s.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:s.ThemeColorMap.HEADER_PRIMARY},close:{color:s.ThemeColorMap.HEADER_PRIMARY}});return n.createElement(W.NavigationContainer,null,n.createElement(z.Navigator,{initialRouteName:"K2egeLocker",style:m.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:m.cardStyle,headerStyle:m.header,headerTitleContainerStyle:m.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},n.createElement(z.Screen,{name:"K2geLocker",component:i,options:{headerTitleStyle:{color:"white"},headerLeft:()=>n.createElement(q,{color:m.close.color,title:"Close",onPress:()=>R.pop()}),...P.TransitionPresets.ModalSlideFromBottomIOS}})))};function j(e,t,i){return window.enmity.utilities.findInReactTree(e,t,i)}const S=Z("K2geLocker"),[ae,me,de,ue]=X(C.byName("MessagesConnected",!1),C.byProps("openLazy","hideActionSheet"),C.byName("GuildTooltipActionSheets",!1),C.byName("GuildsConnected",!1)),he=g("nsfw_gate_lock"),x=g("img_nitro_star"),I=g("Small"),ge=g("ic_locked_24px"),we=g("ic_full_server_gating_24px"),ye={name:"K2geLocker",version:"1.1.0",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[se];let e=()=>{},t="0",i=this.name;h(this.name,"inv_hijack")===void 0&&k(this.name,"inv_hijack",!0),S.after(ue,"default",(l,d,w)=>{S.after(w,"type",(y,f,c)=>{e=c.handleGuildFolderExpand})});const m=S.after(M,"render",(l,d,w)=>{const y=j(w,c=>{var r,u,E;return((r=c.props)==null?void 0:r.delayLongPress)==300&&((u=c.props)==null?void 0:u.onGuildSelected)===void 0&&((E=c.props)==null?void 0:E.guild)});if(y){S.before(y.type,"type",(c,r,u)=>{h(this.name,r[0].guild.id)?r[0].onGuildSelected=E=>{R.push(O,{guildId:E,fn:e})}:r[0].onGuildSelected=void 0});return}const f=j(w,c=>{var r,u,E;return((r=c.props)==null?void 0:r.guildId)&&((u=c.props)==null?void 0:u.yPos)&&((E=c.props)==null?void 0:E.onClose)});!f||(S.after(f.type,"render",(c,r,u)=>(h(this.name,r[0].guildId)?u.props.rows=[{icon:we,text:"Unlock Server",onClick:()=>{R.push(O,{guildId:r[0].guildId,fn:e})}}]:u.props.rows.unshift({icon:ge,text:"Lock Server",onClick:()=>{h(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:I}):h(this.name,r[0].guildId)?a.open({content:"This server is already locked!",source:I}):(k(this.name,r[0].guildId,!0),e(),a.open({content:"Successfully locked!",source:x}))}}),u)),m())});S.instead(de,"default",(l,d,w)=>(t=d[0].guildId,w.apply(l,d))),S.instead(ae,"default",(l,d,w)=>{var y;let f=w.apply(l,d),c=(y=f==null?void 0:f.props)==null?void 0:y.guildId;if(c&&h(this.name,c)){const r=N.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:200,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(M,{style:r.container},n.createElement(_,{style:r.image,source:he}),n.createElement(v,{style:r.header},"This server is locked!"),n.createElement(v,{style:r.text},"enter passcode to unlock"),n.createElement(A,{style:r.passcode,onSubmitEditing:u=>{u.nativeEvent.text==L(h(this.name,"passcode"),`${i[0]}${i[1]}${i[4]}`)?(k(this.name,c,!1),a.open({content:"Successfully unlocked!",source:x})):a.open({content:"Incorrect password. Try again.",source:I})},secureTextEntry:!0}),n.createElement(v,{style:r.footer},"K2geLocker"))}else return f}),S.instead(me,"openLazy",(l,d,w)=>{let y=d[1];(y.startsWith("instant-invite")||y.startsWith("vanity-url-invite"))&&h(this.name,"inv_hijack")?h(this.name,t)?F.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):F.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{h(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:I}):(k(this.name,t,!0),a.open({content:"Successfully locked!",source:x}))},onCancel:()=>{w.apply(l,d)}}):w.apply(l,d)})},onStop(){this.commands=[],S.unpatchAll()},getSettingsPanel({settings:e}){return n.createElement(te,{settings:e})}};V(ye);
