const i=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const l=window.enmity.modules.common.Toasts,F=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const L=window.enmity.modules.common.Navigation,V=window.enmity.modules.common.NavigationNative,P=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const K=window.enmity.modules.common.Linking,M=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function X(e){window.enmity.plugins.registerPlugin(e)}const _={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,n)=>window.enmity.modules.filters.byName(e,n),byTypeName:(e,n)=>window.enmity.modules.filters.byTypeName(e,n),byDisplayName:(e,n)=>window.enmity.modules.filters.byDisplayName(e,n)};function q(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert;const J=o.Button;o.FlatList;const D=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const k=o.Text,Y=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const C=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox,o.FormDivider,o.FormHint,o.FormIcon;const Q=o.FormInput;o.FormLabel,o.FormRadio;const S=o.FormRow,A=o.FormSection;o.FormSelect,o.FormSubLabel;const Z=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function R(e,n,s){window.enmity.settings.set(e,n,s)}function g(e,n,s){return window.enmity.settings.get(e,n,s)}function ee(e){return window.enmity.patcher.create(e)}function h(e){return window.enmity.assets.getIDByName(e)}function N(e,n){let s="";for(let d=0;d<e.length;d++)s+=String.fromCharCode(e.charCodeAt(d)^n.charCodeAt(d%n.length));return s}const{native:I}=window.enmity;function oe(){I.reload()}I.version,I.build,I.device,I.version;const T="Love K2ge3 lol",te=h("img_nitro_star"),ne=h("Small");var re=({settings:e})=>{const n=M.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:50,height:50,marginTop:20,marginLeft:20},description:{flex:1,fontSize:30,paddingTop:20,paddingLeft:30,color:i.ThemeColorMap.HEADER_PRIMARY},info:{height:40,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"}});return t.createElement(C,null,t.createElement(C,{style:n.container},t.createElement(D,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:n.image}),t.createElement(k,{style:n.description},"K2geLocker")),t.createElement(A,{title:"SETTINGS"},t.createElement(Q,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:s=>{if(s.nativeEvent.text=="")l.open({content:"Please enter your custom passcode",source:ne});else{let d=N(s.nativeEvent.text,`${T[5]}${T[6]}${T[0]}`);e.set("passcode",d),l.open({content:"Successfully set new passcode!",source:te})}},secureTextEntry:!0}),t.createElement(S,{label:"Enable invitation menu hijacking",trailing:t.createElement(Z,{value:e.getBoolean("inv_hijack",!0),onValueChange:s=>{e.set("inv_hijack",s)}})}),t.createElement(S,{label:"Reload Discord",style:n.info,trailing:S.Arrow,onPress:()=>{oe()}}),t.createElement(S,{label:"You need to reload Discord after enabling plugin from setting to properly initialize K2geLocker, or you will face problems."})),t.createElement(A,{title:"INFORMATION"},t.createElement(S,{label:"GitHub",style:n.info,trailing:S.Arrow,onPress:()=>{K.openURL("https://github.com/m4fn3/K2geLocker")}}),t.createElement(S,{label:"Twitter",style:n.info,trailing:S.Arrow,onPress:()=>{K.openURL("https://twitter.com/m4fn3")}})))},G;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(G||(G={}));var p;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(p||(p={}));var H;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(H||(H={}));var z;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(z||(z={}));var U;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(U||(U={}));var j;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(j||(j={}));const ie=h("img_nitro_star"),se=h("Small"),le={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:p.Chat,execute:async function(e,n){g("K2geLocker","passcode")===void 0?l.open({content:"Please set passcode in plugin setting before you lock the server!",source:se}):(R("K2geLocker",n.guild.id,!0),l.open({content:"Successfully locked!",source:ie}))}},$=P.createStackNavigator(),x="Love K2ge3 lol",ce=h("nsfw_gate_lock"),ae=h("img_nitro_star"),de=h("Small");var O=({guildId:e,fn:n})=>{function s(){const c=M.createThemedStyleSheet({container:{fontFamily:i.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:i.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:i.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:i.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:i.ThemeColorMap.HEADER_SECONDARY,backgroundColor:i.ThemeColorMap.HEADER_SECONDARY},footer:{color:i.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return t.createElement(C,{style:c.container},t.createElement(D,{style:c.image,source:ce}),t.createElement(k,{style:c.header},"This server is locked!"),t.createElement(k,{style:c.text},"enter passcode to unlock"),t.createElement(Y,{style:c.passcode,onSubmitEditing:m=>{m.nativeEvent.text==N(g("K2geLocker","passcode"),`${x[5]}${x[6]}${x[0]}`)?(R("K2geLocker",e,!1),n(),l.open({content:"Successfully unlocked!",source:ae}),L.pop()):l.open({content:"Incorrect password. Try again.",source:de})},secureTextEntry:!0}),t.createElement(k,{style:c.footer},"K2geLocker"))}const d=M.createThemedStyleSheet({container:{backgroundColor:i.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:i.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:i.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:i.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:i.ThemeColorMap.HEADER_PRIMARY},close:{color:i.ThemeColorMap.HEADER_PRIMARY}});return t.createElement(V.NavigationContainer,null,t.createElement($.Navigator,{initialRouteName:"K2egeLocker",style:d.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:d.cardStyle,headerStyle:d.header,headerTitleContainerStyle:d.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement($.Screen,{name:"K2geLocker",component:s,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(J,{color:d.close.color,title:"Close",onPress:()=>L.pop()}),...P.TransitionPresets.ModalSlideFromBottomIOS}})))};function W(e,n,s){return window.enmity.utilities.findInReactTree(e,n,s)}const f=ee("K2geLocker"),[me,ue,ge,he]=q(_.byName("MessagesConnected",!1),_.byProps("openLazy","hideActionSheet"),_.byName("GuildTooltipActionSheets",!1),_.byName("GuildsConnected",!1)),we=h("nsfw_gate_lock"),B=h("img_nitro_star"),b=h("Small"),ye=h("ic_locked_24px"),fe=h("ic_full_server_gating_24px"),Se={name:"K2geLocker",version:"1.1.0",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[le];let e,n="0",s=this.name;g(this.name,"inv_hijack")===void 0&&R(this.name,"inv_hijack",!0),f.after(he,"default",(c,m,w)=>{f.after(w,"type",(y,E,a)=>{e=a.handleGuildFolderExpand})});const d=f.after(C,"render",(c,m,w)=>{const y=W(w,a=>{var r,u,v;return((r=a.props)==null?void 0:r.delayLongPress)==300&&((u=a.props)==null?void 0:u.onGuildSelected)===void 0&&((v=a.props)==null?void 0:v.guild)});if(y){f.before(y.type,"type",(a,r,u)=>{g(this.name,r[0].guild.id)?r[0].onGuildSelected=v=>{e===void 0?l.open({content:"You need to reload Discord first to properly initialize K2geLocker.",source:b}):L.push(O,{guildId:v,fn:e})}:r[0].onGuildSelected=void 0});return}const E=W(w,a=>{var r,u,v;return((r=a.props)==null?void 0:r.guildId)&&((u=a.props)==null?void 0:u.yPos)&&((v=a.props)==null?void 0:v.onClose)});!E||(f.after(E.type,"render",(a,r,u)=>(g(this.name,r[0].guildId)?u.props.rows=[{icon:fe,text:"Unlock Server",onClick:()=>{e===void 0?l.open({content:"You need to reload Discord first to properly initialize K2geLocker.",source:b}):L.push(O,{guildId:r[0].guildId,fn:e})}}]:u.props.rows.unshift({icon:ye,text:"Lock Server",onClick:()=>{g(this.name,"passcode")===void 0?l.open({content:"Please set passcode in plugin setting before you lock the server!",source:b}):e===void 0?l.open({content:"You need to reload Discord first to properly initialize K2geLocker.",source:b}):g(this.name,r[0].guildId)?l.open({content:"This server is already locked!",source:b}):(R(this.name,r[0].guildId,!0),e(),l.open({content:"Successfully locked!",source:B}))}}),u)),d())});f.instead(ge,"default",(c,m,w)=>(n=m[0].guildId,w.apply(c,m))),f.instead(me,"default",(c,m,w)=>{var y;let E=w.apply(c,m),a=(y=E==null?void 0:E.props)==null?void 0:y.guildId;if(a&&g(this.name,a)){const r=M.createThemedStyleSheet({container:{fontFamily:i.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:i.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:i.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:i.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:i.ThemeColorMap.HEADER_SECONDARY,backgroundColor:i.ThemeColorMap.HEADER_SECONDARY},footer:{color:i.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return t.createElement(C,{style:r.container},t.createElement(D,{style:r.image,source:we}),t.createElement(k,{style:r.header},"This server is locked!"),t.createElement(k,{style:r.text},"enter passcode to unlock"),t.createElement(Y,{style:r.passcode,onSubmitEditing:u=>{u.nativeEvent.text==N(g(this.name,"passcode"),`${s[0]}${s[1]}${s[4]}`)?(R(this.name,a,!1),l.open({content:"Successfully unlocked!",source:B})):l.open({content:"Incorrect password. Try again.",source:b})},secureTextEntry:!0}),t.createElement(k,{style:r.footer},"K2geLocker"))}else return E}),f.instead(ue,"openLazy",(c,m,w)=>{let y=m[1];(y.startsWith("instant-invite")||y.startsWith("vanity-url-invite"))&&g(this.name,"inv_hijack")?g(this.name,n)?F.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):F.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{g(this.name,"passcode")===void 0?l.open({content:"Please set passcode in plugin setting before you lock the server!",source:b}):(R(this.name,n,!0),l.open({content:"Successfully locked!",source:B}))},onCancel:()=>{w.apply(c,m)}}):w.apply(c,m)})},onStop(){this.commands=[],f.unpatchAll()},getSettingsPanel({settings:e}){return t.createElement(re,{settings:e})}};X(Se);
