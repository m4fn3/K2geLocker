const f=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const _=window.enmity.modules.common.Toasts,L=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token;const ne=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const N=window.enmity.modules.common.Navigation,Se=window.enmity.modules.common.NavigationNative,re=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const D=window.enmity.modules.common.Linking,H=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function Ee(e){window.enmity.plugins.registerPlugin(e)}function Le(e){return window.enmity.plugins.getPlugin(e)}const C={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,o)=>window.enmity.modules.filters.byName(e,o),byTypeName:(e,o)=>window.enmity.modules.filters.byTypeName(e,o),byDisplayName:(e,o)=>window.enmity.modules.filters.byDisplayName(e,o)};function Ce(e,o){return window.enmity.modules.getModule(e,o)}function ie(...e){return window.enmity.modules.bulk(...e)}function Ie(...e){return window.enmity.modules.getByProps(...e)}window.enmity.modules.common;const{components:r}=window.enmity;r.Alert;const W=r.Button;r.FlatList;const q=r.Image;r.ImageBackground,r.KeyboardAvoidingView,r.Modal,r.Pressable,r.RefreshControl;const Te=r.ScrollView;r.SectionList,r.StatusBar,r.StyleSheet,r.Switch;const x=r.Text;r.TextInput,r.TouchableHighlight;const Re=r.TouchableOpacity;r.TouchableWithoutFeedback,r.Touchable;const S=r.View;r.VirtualizedList,r.Form,r.FormArrow,r.FormCTA,r.FormCTAButton,r.FormCardSection,r.FormCheckbox,r.FormDivider,r.FormHint,r.FormIcon,r.FormInput,r.FormLabel,r.FormRadio;const g=r.FormRow,le=r.FormSection;r.FormSelect,r.FormSubLabel;const A=r.FormSwitch;r.FormTernaryCheckBox,r.FormText,r.FormTextColors,r.FormTextSizes;function w(e,o,n){window.enmity.settings.set(e,o,n)}function u(e,o,n){return window.enmity.settings.get(e,o,n)}function Pe(e){return window.enmity.patcher.create(e)}function h(e){return window.enmity.assets.getIDByName(e)}function J(e,o,n){return window.enmity.utilities.findInReactTree(e,o,n)}function Me(e=30){return window.enmity.utilities.uuid(e)}var v="K2geLocker",se="1.3.6b",Ne="Lock App / Server with passcode!",xe=[{name:"mafu",id:"519760564755365888"}],Be="#00fa9a",De={name:v,version:se,description:Ne,authors:xe,color:Be};function X(e,o){let n="";for(let y=0;y<e.length;y++)n+=String.fromCharCode(e.charCodeAt(y)^o.charCodeAt(y%o.length));return n}const Ae=Ce(e=>e._dispatcher._actionHandlers._dependencyGraph.nodes),Q=Ae._dispatcher._actionHandlers._dependencyGraph.nodes;function Y(e){let o=Object.keys(Q).filter(n=>Q[n].name===e);if(o.length)return Q[o[0]].actionHandler;console.error(`[K2geLocker->getStoreHandlers] ${e} couldn't be found.`)}function Ke(e,o){let n=[];const y=e.after(S,"render",(R,E,I)=>{Object.keys(o).forEach(P=>{n.includes(P)||o[P](E,I,()=>{n.push(P)})}),n.length===Object.keys(o).length&&y()})}const{native:U}=window.enmity;function ce(){U.reload()}U.version,U.build,U.device,U.version;const Fe="https://github.com/m4fn3/K2geLocker",Oe="https://raw.githubusercontent.com/m4fn3/K2geLocker/master/manifest.json",Ge="https://raw.githubusercontent.com/m4fn3/K2geLocker/master/dist/K2geLocker.js",Ue="https://raw.githubusercontent.com/m4fn3/K2geLocker/master/changelogs.json";function $e(e,o){window.enmity.plugins.installPlugin(Ge,()=>{L.show({title:"K2geLocker",body:`Updated from ${e} to ${o}!
Do you want to reload Discord now?`,confirmText:"Yes",cancelText:"Later",onConfirm:()=>ce()})})}function ae(e=!1){ne.get(Oe).then(o=>{const n=JSON.parse(o.text),y=Le(n.name);n.version.localeCompare(y.version,void 0,{numeric:!0})===1?(e||!e&&u(v,"ignored")!=n.version)&&ne.get(Ue).then(R=>{const E=JSON.parse(R.text);let I="";E[n.version]&&(I=`

- Changelogs
${E[n.version]}`),L.show({title:"K2geLocker",body:`New version v${n.version} is available!${I}`,confirmText:"Update",cancelText:"Ignore",onConfirm:()=>{w(v,"_updating",!0),$e(y.version,n.version)},onCancel:()=>w(v,"ignored",n.version)})}):e&&L.show({title:"K2geLocker",body:`You are using latest version v${y.version}!`,confirmText:"OK"})}).catch(o=>{o.status===404&&L.show({title:"K2geLocker",body:"Failed to check for updates. Please check GitHub manually.",confirmText:"GitHub",cancelText:"Close",onConfirm:()=>D.openURL(Fe)})})}const de=re.createStackNavigator(),[He]=ie(C.byProps("AppState")),K="Love K2ge3 lol";h("nsfw_gate_lock");const Ye=h("img_nitro_star");h("ic_following");const je=h("ic_info_24px"),ue=h("Small"),Ve=h("ic_arrow_back_24px"),$=H.createThemedStyleSheet({container:{backgroundColor:f.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:f.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:f.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:f.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:f.ThemeColorMap.HEADER_PRIMARY},close:{color:f.ThemeColorMap.HEADER_PRIMARY}});function Z({callbackBefore:e=()=>{},callbackAfter:o=()=>{},isSetup:n=!1,showClose:y=!0,isUnlock:R=!1,component:E=null}){const I=He.useWindowDimensions().width,P=Math.min(I,450);function F(){const p=H.createThemedStyleSheet({container:{flex:1,backgroundColor:f.ThemeColorMap.BACKGROUND_PRIMARY,alignSelf:"center",alignItems:"center",justifyContent:"center",width:P},title:{height:40},titleText:{color:f.ThemeColorMap.HEADER_PRIMARY,fontSize:30},circleBox:{flexDirection:"row",height:130,paddingTop:20},white_circle:{width:20,height:20,borderRadius:10,backgroundColor:"white",marginRight:10},gray_circle:{width:20,height:20,borderRadius:10,backgroundColor:"gray",marginRight:10},numberBox:{flexDirection:"row",flexWrap:"wrap",width:300},number:{width:100,height:70,alignItems:"center",justifyContent:"center"},numberText:{color:f.ThemeColorMap.HEADER_PRIMARY,fontSize:30}});let O=u(v,"passcode"),i=O===void 0?"pass":X(O,`${K[5]}${K[6]}${K[0]}`);const[l,c]=t.useState(""),[a,d]=t.useState("");let s=new Array(i.length).fill(p.gray_circle);const[m,k]=t.useState(s);let z=n?"Enter new passcode":"Enter passcode ";return z=R?"Unlock Server Lock":z,t.createElement(S,{style:p.container},t.createElement(S,{style:p.title},t.createElement(x,{style:p.titleText},z)),t.createElement(S,{style:p.circleBox},m.map((M,B)=>t.createElement(S,{style:m[B]}))),t.createElement(S,{style:p.numberBox},[1,2,3,4,5,6,7,8,9,"",0,"back"].map((M,B)=>M!==""?t.createElement(Re,{style:p.number,key:B,onPress:()=>{if(typeof M=="number"){let T=a+M.toString();d(T);let G=m;G[T.length-1]=p.white_circle,k(G),T.length===m.length&&setTimeout(()=>{if(!n)T===i?(e(),N.pop(),o()):(d(""),k(s),_.open({content:"Incorrect password. Try again.",source:ue}));else if(!l)c(T),d(""),s=new Array(m.length).fill(p.gray_circle),k(s),_.open({content:"Retype new passcode to confirm.",source:je});else{if(l===T){let ve=X(l,`${K[5]}${K[6]}${K[0]}`);w(v,"passcode",ve),_.open({content:"Successfully set new passcode!",source:Ye})}else _.open({content:"Passcode didn't match.",source:ue});N.pop()}},200)}else{let T=a.slice(0,-1);d(T);let G=m;G[T.length]=p.gray_circle,k(G)}}},typeof M=="number"?t.createElement(x,{style:p.numberText},M):t.createElement(q,{source:Ve})):t.createElement(S,{style:p.number,key:B}))),t.createElement(S,null,[1].filter(M=>n&&!l).map(M=>t.createElement(W,{onPress:()=>{let B=m.length===4?6:4;s=new Array(B).fill(p.gray_circle),k(s),d("")},title:"Change passcode length"}))))}return t.createElement(Se.NavigationContainer,{independent:!0},t.createElement(de.Navigator,{initialRouteName:"K2geLocker",style:$.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:$.cardStyle,headerStyle:$.header,headerTitleContainerStyle:$.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(de.Screen,{name:"K2geLocker",component:E||F,options:{headerTitleStyle:{color:"white"},headerLeft:()=>{if(y)return t.createElement(W,{color:$.close.color,title:"Close",onPress:()=>N.pop()})},...re.TransitionPresets.ModalSlideFromBottomIOS}})))}const ze="Love K2ge3 lol",We="https://github.com/m4fn3/K2geLocker/blob/master/K2genmity.md";h("img_nitro_star"),h("Small");const qe=h("img_account_sync_github_white"),Je=h("Discord"),Xe=h("img_account_sync_twitter_white"),Qe=h("ic_message_retry"),Ze=h("hub-invite"),et=h("ic_hammer_and_chisel_24px"),tt=h("ic_lock"),ot=h("toast_image_saved"),nt=h("ic_drag_icon_24px"),rt=h("voice_bar_phone"),it=h("ic_hide"),lt=Ie("acceptInviteAndTransitionToInviteChannel");var st=({settings:e})=>{const o=H.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:f.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:f.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:f.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}});return t.createElement(Te,null,t.createElement(S,{style:o.container},t.createElement(q,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:o.image}),t.createElement(S,{style:o.title},t.createElement(x,{style:o.name},"K2geLocker"),t.createElement(x,{style:o.author},"by mafu"))),t.createElement(le,{title:"SETTINGS"},t.createElement(g,{label:"Setup Passcode",trailing:g.Arrow,leading:t.createElement(g.Icon,{source:nt}),subLabel:"Open password setup modal",onPress:()=>{N.push(Z,{isSetup:!0})}}),t.createElement(g,{label:"Reload Discord",trailing:g.Arrow,leading:t.createElement(g.Icon,{source:Qe}),subLabel:"Reloading is required in order to properly initialize K2geLocker after enabling plugin",onPress:()=>{ce()}}),t.createElement(g,{label:"Enable app-wide locking",subLabel:"You can lock entire app with passcode!",leading:t.createElement(g.Icon,{source:tt}),trailing:t.createElement(A,{value:e.getBoolean("lock_app",!1),onValueChange:n=>{n&&e.get("passcode")===void 0?(n=!1,L.show({title:"K2geLocker",body:"Please set passcode first!",confirmText:"Ok"})):(e.set("lock_app",n),w(ze,"_locked",!1))}})}),t.createElement(g,{label:"Use biometrics authentication",subLabel:"**Using K2genmity is required to get Touch/Face ID to work**",leading:t.createElement(g.Icon,{source:rt}),trailing:t.createElement(A,{value:e.getBoolean("use_bio",!1),onValueChange:n=>{e.get("_isK2genmity")?e.get("_hasBiometricsPerm")?e.set("use_bio",n):(n=!1,L.show({title:"K2geLocker",body:"Please enable biometrics permission by editing Info.plist!",confirmText:"Ok"})):(n=!1,L.show({title:"K2geLocker",body:"Installing K2genmity is required to use biometrics authentication feature!",confirmText:"Check install instructions",cancelText:"Later",onConfirm:()=>{D.openURL(We)}}))}})}),t.createElement(g,{label:"Persist server lock",subLabel:"Persist locking until you unlock the server lock by long-pressing the icon or using /unlock command.",leading:t.createElement(g.Icon,{source:et}),trailing:t.createElement(A,{value:e.getBoolean("persist_lock",!1),onValueChange:n=>{e.set("persist_lock",n)}})}),t.createElement(g,{label:"Enable invitation menu hijacking",subLabel:"Useful for iPad on which can't long press icon. For servers with inv disabled, use /lock command.",leading:t.createElement(g.Icon,{source:Ze}),trailing:t.createElement(A,{value:e.getBoolean("inv_hijack",!0),onValueChange:n=>{e.set("inv_hijack",n)}})}),t.createElement(g,{label:"Gray out locked server",subLabel:"Gray out the icon of locked servers.",leading:t.createElement(g.Icon,{source:it}),trailing:t.createElement(A,{value:e.getBoolean("gray_out",!0),onValueChange:n=>{e.set("gray_out",n)}})}),t.createElement(g,{label:"Check for updates",subLabel:"Whether automatically check or not. You can tap here to check manually too.",leading:t.createElement(g.Icon,{source:ot}),trailing:t.createElement(A,{value:e.getBoolean("check_updates",!0),onValueChange:n=>{e.set("check_updates",n)}}),onPress:()=>{ae(!0)}})),t.createElement(le,{title:"INFORMATION"},t.createElement(g,{label:"Follow me on Twitter",style:o.info,trailing:g.Arrow,leading:t.createElement(g.Icon,{source:Xe}),onPress:()=>{D.openURL("https://twitter.com/m4fn3")}}),t.createElement(g,{label:"Visit my server for help",style:o.info,trailing:g.Arrow,leading:t.createElement(g.Icon,{source:Je}),onPress:()=>{lt.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{N.pop()}})}}),t.createElement(g,{label:"Check Source on GitHub",style:o.info,trailing:g.Arrow,leading:t.createElement(g.Icon,{source:qe}),onPress:()=>{D.openURL("https://github.com/m4fn3/K2geLocker")}})),t.createElement(x,{style:o.footer},`v${se}`))},me;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(me||(me={}));var j;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(j||(j={}));var ge;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(ge||(ge={}));var he;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(he||(he={}));var ye;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(ye||(ye={}));var we;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(we||(we={}));const fe=h("img_nitro_star"),ct=h("Small"),at={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:j.Chat,execute:async function(e,o){u(v,"passcode")===void 0?_.open({content:"Please set passcode in plugin setting before you lock the server!",source:ct}):(w(v,o.guild.id,!0),_.open({content:"Successfully locked!",source:fe}))}},dt={id:"unlock",name:"unlock",displayName:"unlock",description:"Unlock server lock",displayDescription:"Unlock server lock",type:j.Chat,execute:async function(e,o){w(v,o.guild.id,!1),_.open({content:"Successfully unlocked!",source:fe})}},V={};D.addEventListener("url",e=>{let o=e.url;o=decodeURIComponent(o.replace("com.hammerandchisel.discord://",""));try{const n=JSON.parse(o);if(n.data===void 0)return;V[n.id]&&(V[n.id](n.data),delete V[n.id])}catch{return}});function pe(e,o=[],n){const y=Me();D.openURL(`com.hammerandchisel.discord://enmity?id=${y}&command=${e}&params=${o.join(",")}`).then(()=>{n&&(V[y]=n)})}const b=Pe("K2geLocker"),[ut,mt,gt,be,ht,yt,ke,wt,ee]=ie(C.byName("MessagesConnected",!1),C.byName("MessagesWrapperConnected",!1),C.byProps("openLazy","hideActionSheet"),C.byProps("getLastSelectedGuildId"),C.byProps("getMostRecentSelectedTextChannelId"),C.byName("GuildTooltipActionSheets",!1),C.byProps("transitionTo"),C.byProps("getChannels"),C.byProps("popModal")),[ft,pt,bt,_e]=[Y("AppStateStore"),Y("DeveloperOptionsStore"),Y("DefaultRouteStore"),Y("ModalDeprecatedStore")],kt=h("nsfw_gate_lock"),te=h("img_nitro_star"),oe=h("Small"),_t=h("ic_locked_24px"),vt=h("ic_full_server_gating_24px");function St(e,o,n=!1){(n||u("K2geLocker",e)===void 0)&&w("K2geLocker",e,o)}const Et={...De,onStart(){this.commands=[at,dt];let e=this.name;[["inv_hijack",!0],["check_updates",!0],["lock_app",!1],["use_bio",!1],["persist_lock",!1],["gray_out",!0],["_isK2genmity",!1,!0],["_hasBiometricsPerm",!1,!0]].forEach(i=>{St(...i)});let o=null;function n(i){let l=ht.getMostRecentSelectedTextChannelId(i);o=i;let c=wt.getChannels(i).SELECTABLE;if(c.length!==1){let a=c[0].channel.id!=l?c[0].channel.id:c[1].channel.id;ke.transitionTo(`/channels/${i}/${a}`,void 0)}ke.transitionTo(`/channels/${i}/${l}`,void 0)}function y(i,l=()=>{},c=()=>{}){u(e,"use_bio")&&setTimeout(()=>{pe("K2geLocker",["authentication"],a=>{a=="success"&&(l(),N.pop(),c())})},i)}function R(i,l=!1){let c=u(v,"persist_lock");const a=()=>{(!c||c&&l)&&(w(e,i,!1),_.open({content:"Successfully unlocked!",source:te}))},d=()=>{n(i)};N.push(Z,{callbackBefore:a,callbackAfter:d,isUnlock:c&&l}),y(300,a,d)}const E=()=>{w(e,"_locked",!1)};function I(){N.push(Z,{callbackBefore:E,showClose:!1})}_e?["MODAL_POP_ALL","CHANGE_LOG_CLOSE","CHANNEL_SETTINGS_CLOSE","GUILD_SETTINGS_CLOSE","EMAIL_VERIFICATION_MODAL_CLOSE","NOTIFICATION_SETTINGS_MODAL_CLOSE","SEARCH_MODAL_CLOSE","USER_SETTINGS_MODAL_CLOSE","MENTION_MODAL_CLOSE"].forEach(i=>{b.instead(_e,i,(l,c,a)=>{u(e,"_locked")||a.apply(l,c)})}):ee&&(b.instead(ee,"popModal",(i,l,c)=>{u(e,"_locked")||c.apply(i,l)}),b.instead(ee,"popAllModals",(i,l,c)=>{u(e,"_locked")||c.apply(i,l)}));let P=!0;b.before(bt,"SAVE_LAST_ROUTE",(i,l,c)=>{P&&(u(e,"lock_app")&&u(e,"passcode")!==void 0&&(I(),y(100,E)),P=!1)});let F=!1;b.before(ft,"APP_STATE_UPDATE",(i,l,c)=>{let a=l[0].state;u(e,"lock_app")&&(u(e,"passcode")===void 0?w(e,"lock_app",!1):a=="background"?(u(e,"_locked")||(I(),w(e,"_locked",!0)),F=!0):a=="active"&&u(e,"_locked")&&F&&(F=!1,y(100,E)))}),Ke(b,{Guild:(i,l,c)=>{const a=J(l,d=>{var s,m,k;return((s=d.props)==null?void 0:s.delayLongPress)==300&&((m=d.props)==null?void 0:m.onGuildSelected)===void 0&&((k=d.props)==null?void 0:k.guild)});a&&(b.before(a.type,"type",(d,s,m)=>{u(e,s[0].guild.id)?u(e,"passcode")===void 0?(w(e,s[0].guild.id,void 0),s[0].onGuildSelected=void 0):s[0].onGuildSelected=R:s[0].onGuildSelected=void 0}),c())},GuildPopoutMenu:(i,l,c)=>{const a=J(l,d=>{var s,m,k;return((s=d.props)==null?void 0:s.guildId)&&((m=d.props)==null?void 0:m.yPos)&&((k=d.props)==null?void 0:k.onClose)});a&&(b.after(a.type,"render",(d,s,m)=>(u(e,s[0].guildId)?m.props.rows=[{icon:vt,text:"Unlock Server",onClick:()=>{R(s[0].guildId,!0)}}]:m.props.rows.unshift({icon:_t,text:"Lock Server",onClick:()=>{if(u(e,"passcode")===void 0)_.open({content:"Please set passcode in plugin setting before you lock the server!",source:oe});else if(u(e,s[0].guildId))_.open({content:"This server is already locked!",source:oe});else{w(e,s[0].guildId,!0);let k=be.getLastSelectedGuildId();s[0].guildId!==k&&n(s[0].guildId),_.open({content:"Successfully locked!",source:te})}}}),m)),c())},GuildIcon:(i,l,c)=>{const a=J(l,d=>{var s,m;return((s=d.props)==null?void 0:s.animate)!==void 0&&((m=d.props)==null?void 0:m.selected)!==void 0});a&&b.before(a,"type",(d,s,m)=>{u(e,s[0].guild.id)&&u(v,"gray_out")?s[0].style.opacity=.3:s[0].style.opacity=1})}}),b.instead(yt,"default",(i,l,c)=>(o!==l[0].guildId&&(o=null),c.apply(i,l)));const p=ut||mt;b.instead(p,"default",(i,l,c)=>{var a;let d=c.apply(i,l),s=(a=d==null?void 0:d.props)==null?void 0:a.guildId;if(s&&u(e,s)&&o!==s){const m=H.createThemedStyleSheet({container:{fontFamily:f.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:f.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:f.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25,marginBottom:30},button:{fontSize:30},footer:{color:f.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:80,marginBottom:70}});return t.createElement(S,{style:m.container},t.createElement(q,{style:m.image,source:kt}),t.createElement(x,{style:m.header},"This server is locked!"),t.createElement(W,{style:m.button,onPress:()=>R(s),title:"Enter passcode"}),t.createElement(x,{style:m.footer},"K2geLocker"))}else return d}),b.instead(gt,"openLazy",(i,l,c)=>{let a=l[1];if((a.startsWith("instant-invite")||a.startsWith("vanity-url-invite"))&&u(e,"inv_hijack")){let d=be.getLastSelectedGuildId();u(e,d)?L.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):L.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{u(e,"passcode")===void 0?_.open({content:"Please set passcode in plugin setting before you lock the server!",source:oe}):(w(e,d,!0),_.open({content:"Successfully locked!",source:te}))},onCancel:()=>{c.apply(i,l)}})}else c.apply(i,l)}),b.before(pt,"LOGOUT",(i,l,c)=>{L.show({title:"K2geLocker",body:`Automatically disabled itself to prevent app from causing problems!
Please enable plugin manually after you re-login to the account.`,confirmText:"See you again!"}),this.commands=[],b.unpatchAll(),window.enmity.plugins.disablePlugin("K2geLocker")}),pe("K2geLocker",["check"],i=>{w(e,"_isK2genmity",!0),i=="yes"&&w(e,"_hasBiometricsPerm",!0)}),u(e,"check_updates")&&(u(e,"_updating")?w(v,"_updating",!1):ae());let O=u(v,"passcode");if(O!==void 0){let i=X(O,`${e[0]}${e[1]}${e[4]}`);isNaN(i)&&w(e,"passcode",void 0)}setTimeout(()=>console.error("[End]"),3e3)},onStop(){this.commands=[],b.unpatchAll()},getSettingsPanel({settings:e}){return t.createElement(st,{settings:e})}};Ee(Et);
