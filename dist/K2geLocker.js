const m=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const r=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const i=window.enmity.modules.common.Toasts,E=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const _=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function P(e){window.enmity.plugins.registerPlugin(e)}const S={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,t)=>window.enmity.modules.filters.byName(e,t),byTypeName:(e,t)=>window.enmity.modules.filters.byTypeName(e,t),byDisplayName:(e,t)=>window.enmity.modules.filters.byDisplayName(e,t)};function C(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert,o.Button,o.FlatList;const K=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const v=o.Text,U=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const F=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox;const j=o.FormDivider;o.FormHint,o.FormIcon;const z=o.FormInput;o.FormLabel,o.FormRadio;const G=o.FormRow,H=o.FormSection;o.FormSelect,o.FormSubLabel;const V=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function w(e,t,n){window.enmity.settings.set(e,t,n)}function l(e,t,n){return window.enmity.settings.get(e,t,n)}function Y(e){return window.enmity.patcher.create(e)}function c(e){return window.enmity.assets.getIDByName(e)}function R(e,t){let n="";for(let s=0;s<e.length;s++)n+=String.fromCharCode(e.charCodeAt(s)^t.charCodeAt(s%t.length));return n}const f="Love K2ge3 lol",$=c("img_nitro_star"),W=c("Small");var T=({settings:e})=>r.createElement(F,null,r.createElement(H,{title:"Settings"},r.createElement(z,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:t=>{if(t.nativeEvent.text=="")i.open({content:"Please enter your custom passcode",source:W});else{let n=R(t.nativeEvent.text,`${f[5]}${f[6]}${f[0]}`);e.set("passcode",n),i.open({content:"Successfully set new passcode!",source:$})}},secureTextEntry:!0}),r.createElement(j,null),r.createElement(G,{label:"Enable invitation menu hijacking",trailing:r.createElement(V,{value:e.getBoolean("inv_hijack",!0),onValueChange:t=>{e.set("inv_hijack",t)}})}))),L;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(L||(L={}));var b;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(b||(b={}));var x;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(x||(x={}));var B;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(B||(B={}));var N;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(N||(N={}));var D;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(D||(D={}));const q=c("img_nitro_star"),J=c("Small"),Q={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:b.Chat,execute:async function(e,t){l("K2geLocker","passcode")===void 0?i.open({content:"Please set passcode in plugin setting before you lock the server!",source:J}):(w("K2geLocker",t.guild.id,!0),i.open({content:"Successfully locked!",source:q}))}},h=Y("K2geLocker"),[X,Z,A]=C(S.byName("MessagesConnected",!1),S.byProps("openLazy","hideActionSheet"),S.byName("GuildTooltipActionSheets",!1)),O=c("nsfw_gate_lock"),M=c("img_nitro_star"),k=c("Small"),p={name:"K2geLocker",version:"1.0.2",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[Q];let e="0",t=this.name;l(this.name,"inv_hijack")===void 0&&w(this.name,"inv_hijack",!0),h.instead(A,"default",(n,s,a)=>(e=s[0].guildId,a.apply(n,s))),h.instead(X,"default",(n,s,a)=>{var u;let g=a.apply(n,s),y=(u=g==null?void 0:g.props)==null?void 0:u.guildId;if(y&&l(this.name,y)){const d=_.createThemedStyleSheet({container:{fontFamily:m.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:m.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:m.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:m.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:m.ThemeColorMap.HEADER_SECONDARY,backgroundColor:m.ThemeColorMap.HEADER_SECONDARY},footer:{color:m.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return r.createElement(F,{style:d.container},r.createElement(K,{style:d.image,source:O}),r.createElement(v,{style:d.header},"This server is locked!"),r.createElement(v,{style:d.text},"enter passcode to unlock"),r.createElement(U,{style:d.passcode,onSubmitEditing:I=>{I.nativeEvent.text==R(l(this.name,"passcode"),`${t[0]}${t[1]}${t[4]}`)?(w(this.name,y,!1),i.open({content:"Successfully unlocked!",source:M})):i.open({content:"Incorrect password. Try again.",source:k})},secureTextEntry:!0}),r.createElement(v,{style:d.footer},"K2geLocker"))}else return g}),h.instead(Z,"openLazy",(n,s,a)=>{let u=s[1];console.log(u),(u.startsWith("instant-invite")||u.startsWith("vanity-url-invite"))&&l(this.name,"inv_hijack")?l(this.name,e)?E.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):E.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{l(this.name,"passcode")===void 0?i.open({content:"Please set passcode in plugin setting before you lock the server!",source:k}):e=="0"?i.open({content:"It seems that plugin failed to get the server. Please select another channel and try again!",source:k}):(w(this.name,e,!0),i.open({content:"Successfully locked!",source:M}))},onCancel:()=>{a.apply(n,s)}}):a.apply(n,s)})},onStop(){this.commands=[],h.unpatchAll()},getSettingsPanel({settings:e}){return r.createElement(T,{settings:e})}};P(p);
