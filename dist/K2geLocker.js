const s=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const a=window.enmity.modules.common.Toasts,x=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const b=window.enmity.modules.common.Navigation,j=window.enmity.modules.common.NavigationNative,F=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const _=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function O(e){window.enmity.plugins.registerPlugin(e)}const R={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,t)=>window.enmity.modules.filters.byName(e,t),byTypeName:(e,t)=>window.enmity.modules.filters.byTypeName(e,t),byDisplayName:(e,t)=>window.enmity.modules.filters.byDisplayName(e,t)};function W(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert;const p=o.Button;o.FlatList;const T=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const E=o.Text,P=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const C=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox;const V=o.FormDivider;o.FormHint,o.FormIcon;const X=o.FormInput;o.FormLabel,o.FormRadio;const q=o.FormRow,J=o.FormSection;o.FormSelect,o.FormSubLabel;const Q=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function k(e,t,i){window.enmity.settings.set(e,t,i)}function h(e,t,i){return window.enmity.settings.get(e,t,i)}function Z(e){return window.enmity.patcher.create(e)}function g(e){return window.enmity.assets.getIDByName(e)}function I(e,t){let i="";for(let m=0;m<e.length;m++)i+=String.fromCharCode(e.charCodeAt(m)^t.charCodeAt(m%t.length));return i}const N="Love K2ge3 lol",ee=g("img_nitro_star"),oe=g("Small");var te=({settings:e})=>n.createElement(C,null,n.createElement(J,{title:"Settings"},n.createElement(X,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:t=>{if(t.nativeEvent.text=="")a.open({content:"Please enter your custom passcode",source:oe});else{let i=I(t.nativeEvent.text,`${N[5]}${N[6]}${N[0]}`);e.set("passcode",i),a.open({content:"Successfully set new passcode!",source:ee})}},secureTextEntry:!0}),n.createElement(V,null),n.createElement(q,{label:"Enable invitation menu hijacking",trailing:n.createElement(Q,{value:e.getBoolean("inv_hijack",!0),onValueChange:t=>{e.set("inv_hijack",t)}})}))),K;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(K||(K={}));var D;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(D||(D={}));var Y;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(Y||(Y={}));var A;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(A||(A={}));var G;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(G||(G={}));var H;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(H||(H={}));const ne=g("img_nitro_star"),re=g("Small"),se={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:D.Chat,execute:async function(e,t){h("K2geLocker","passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:re}):(k("K2geLocker",t.guild.id,!0),a.open({content:"Successfully locked!",source:ne}))}},U=F.createStackNavigator(),L="Love K2ge3 lol",ie=g("nsfw_gate_lock"),le=g("img_nitro_star"),ce=g("Small");var z=({guildId:e,fn:t})=>{function i(){const l=_.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(C,{style:l.container},n.createElement(T,{style:l.image,source:ie}),n.createElement(E,{style:l.header},"This server is locked!"),n.createElement(E,{style:l.text},"enter passcode to unlock"),n.createElement(P,{style:l.passcode,onSubmitEditing:d=>{d.nativeEvent.text==I(h("K2geLocker","passcode"),`${L[5]}${L[6]}${L[0]}`)?(k("K2geLocker",e,!1),t(),a.open({content:"Successfully unlocked!",source:le}),b.pop()):a.open({content:"Incorrect password. Try again.",source:ce})},secureTextEntry:!0}),n.createElement(E,{style:l.footer},"K2geLocker"))}const m=_.createThemedStyleSheet({container:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:s.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:s.ThemeColorMap.HEADER_PRIMARY},close:{color:s.ThemeColorMap.HEADER_PRIMARY}});return n.createElement(j.NavigationContainer,null,n.createElement(U.Navigator,{initialRouteName:"K2egeLocker",style:m.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:m.cardStyle,headerStyle:m.header,headerTitleContainerStyle:m.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},n.createElement(U.Screen,{name:"K2geLocker",component:i,options:{headerTitleStyle:{color:"white"},headerLeft:()=>n.createElement(p,{color:m.close.color,title:"Close",onPress:()=>b.pop()}),...F.TransitionPresets.ModalSlideFromBottomIOS}})))};function $(e,t,i){return window.enmity.utilities.findInReactTree(e,t,i)}const S=Z("K2geLocker"),[ae,me,de,ue]=W(R.byName("MessagesConnected",!1),R.byProps("openLazy","hideActionSheet"),R.byName("GuildTooltipActionSheets",!1),R.byName("GuildsConnected",!1)),he=g("nsfw_gate_lock"),B=g("img_nitro_star"),M=g("Small"),ge=g("ic_locked_24px"),we=g("ic_full_server_gating_24px"),ye={name:"K2geLocker",version:"1.1.0",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[se];let e=()=>{},t="0",i=this.name;h(this.name,"inv_hijack")===void 0&&k(this.name,"inv_hijack",!0),S.after(ue,"default",(l,d,w)=>{S.after(w,"type",(y,f,c)=>{e=c.handleGuildFolderExpand})});const m=S.after(C,"render",(l,d,w)=>{const y=$(w,c=>{var r,u,v;return((r=c.props)==null?void 0:r.delayLongPress)==300&&((u=c.props)==null?void 0:u.onGuildSelected)===void 0&&((v=c.props)==null?void 0:v.guild)});if(y){S.before(y.type,"type",(c,r,u)=>{h(this.name,r[0].guild.id)?r[0].onGuildSelected=v=>{b.push(z,{guildId:v,fn:e})}:r[0].onGuildSelected=void 0});return}const f=$(w,c=>{var r,u,v;return((r=c.props)==null?void 0:r.guildId)&&((u=c.props)==null?void 0:u.yPos)&&((v=c.props)==null?void 0:v.onClose)});!f||(S.after(f.type,"render",(c,r,u)=>(h(this.name,r[0].guildId)?u.props.rows=[{icon:we,text:"Unlock Server",onClick:()=>{b.push(z,{guildId:r[0].guildId,fn:e})}}]:u.props.rows.unshift({icon:ge,text:"Lock Server",onClick:()=>{h(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:M}):h(this.name,r[0].guildId)?a.open({content:"This server is already locked!",source:M}):(k(this.name,r[0].guildId,!0),e(),a.open({content:"Successfully locked!",source:B}))}}),u)),m())});S.instead(de,"default",(l,d,w)=>(t=d[0].guildId,w.apply(l,d))),S.instead(ae,"default",(l,d,w)=>{var y;let f=w.apply(l,d),c=(y=f==null?void 0:f.props)==null?void 0:y.guildId;if(c&&h(this.name,c)){const r=_.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(C,{style:r.container},n.createElement(T,{style:r.image,source:he}),n.createElement(E,{style:r.header},"This server is locked!"),n.createElement(E,{style:r.text},"enter passcode to unlock"),n.createElement(P,{style:r.passcode,onSubmitEditing:u=>{u.nativeEvent.text==I(h(this.name,"passcode"),`${i[0]}${i[1]}${i[4]}`)?(k(this.name,c,!1),a.open({content:"Successfully unlocked!",source:B})):a.open({content:"Incorrect password. Try again.",source:M})},secureTextEntry:!0}),n.createElement(E,{style:r.footer},"K2geLocker"))}else return f}),S.instead(me,"openLazy",(l,d,w)=>{let y=d[1];(y.startsWith("instant-invite")||y.startsWith("vanity-url-invite"))&&h(this.name,"inv_hijack")?h(this.name,t)?x.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):x.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{h(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:M}):(k(this.name,t,!0),a.open({content:"Successfully locked!",source:B}))},onCancel:()=>{w.apply(l,d)}}):w.apply(l,d)})},onStop(){this.commands=[],S.unpatchAll()},getSettingsPanel({settings:e}){return n.createElement(te,{settings:e})}};O(ye);
