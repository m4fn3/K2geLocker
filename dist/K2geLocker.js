const s=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const a=window.enmity.modules.common.Toasts,B=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const b=window.enmity.modules.common.Navigation,z=window.enmity.modules.common.NavigationNative,x=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const C=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function j(e){window.enmity.plugins.registerPlugin(e)}const M={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,t)=>window.enmity.modules.filters.byName(e,t),byTypeName:(e,t)=>window.enmity.modules.filters.byTypeName(e,t),byDisplayName:(e,t)=>window.enmity.modules.filters.byDisplayName(e,t)};function O(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:o}=window.enmity;o.Alert;const V=o.Button;o.FlatList;const F=o.Image;o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch;const E=o.Text,T=o.TextInput;o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable;const k=o.View;o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox;const W=o.FormDivider;o.FormHint,o.FormIcon;const p=o.FormInput;o.FormLabel,o.FormRadio;const X=o.FormRow,q=o.FormSection;o.FormSelect,o.FormSubLabel;const J=o.FormSwitch;o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;function f(e,t,l){window.enmity.settings.set(e,t,l)}function d(e,t,l){return window.enmity.settings.get(e,t,l)}function Q(e){return window.enmity.patcher.create(e)}function u(e){return window.enmity.assets.getIDByName(e)}function _(e,t){let l="";for(let i=0;i<e.length;i++)l+=String.fromCharCode(e.charCodeAt(i)^t.charCodeAt(i%t.length));return l}const I="Love K2ge3 lol",Z=u("img_nitro_star"),ee=u("Small");var oe=({settings:e})=>n.createElement(k,null,n.createElement(q,{title:"Settings"},n.createElement(p,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:t=>{if(t.nativeEvent.text=="")a.open({content:"Please enter your custom passcode",source:ee});else{let l=_(t.nativeEvent.text,`${I[5]}${I[6]}${I[0]}`);e.set("passcode",l),a.open({content:"Successfully set new passcode!",source:Z})}},secureTextEntry:!0}),n.createElement(W,null),n.createElement(X,{label:"Enable invitation menu hijacking",trailing:n.createElement(J,{value:e.getBoolean("inv_hijack",!0),onValueChange:t=>{e.set("inv_hijack",t)}})}))),P;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(P||(P={}));var N;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(N||(N={}));var K;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(K||(K={}));var Y;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(Y||(Y={}));var A;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(A||(A={}));var G;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(G||(G={}));const te=u("img_nitro_star"),ne=u("Small"),re={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:N.Chat,execute:async function(e,t){d("K2geLocker","passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:ne}):(f("K2geLocker",t.guild.id,!0),a.open({content:"Successfully locked!",source:te}))}},H=x.createStackNavigator(),D="Love K2ge3 lol",se=u("nsfw_gate_lock"),ie=u("img_nitro_star"),le=u("Small");var U=({guildId:e})=>{function t(){const i=C.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(k,{style:i.container},n.createElement(F,{style:i.image,source:se}),n.createElement(E,{style:i.header},"This server is locked!"),n.createElement(E,{style:i.text},"enter passcode to unlock"),n.createElement(T,{style:i.passcode,onSubmitEditing:h=>{h.nativeEvent.text==_(d("K2geLocker","passcode"),`${D[5]}${D[6]}${D[0]}`)?(f("K2geLocker",e,!1),a.open({content:"Successfully unlocked!",source:ie})):a.open({content:"Incorrect password. Try again.",source:le})},secureTextEntry:!0}),n.createElement(E,{style:i.footer},"K2geLocker"))}const l=C.createThemedStyleSheet({container:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:s.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:s.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:s.ThemeColorMap.HEADER_PRIMARY},close:{color:s.ThemeColorMap.HEADER_PRIMARY}});return n.createElement(z.NavigationContainer,null,n.createElement(H.Navigator,{initialRouteName:"K2egeLocker",style:l.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:l.cardStyle,headerStyle:l.header,headerTitleContainerStyle:l.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},n.createElement(H.Screen,{name:"K2geLocker",component:t,options:{headerTitleStyle:{color:"white"},headerLeft:()=>n.createElement(V,{color:l.close.color,title:"Close",onPress:()=>b.pop()}),...x.TransitionPresets.ModalSlideFromBottomIOS}})))};function $(e,t,l){return window.enmity.utilities.findInReactTree(e,t,l)}const S=Q("K2geLocker"),[ce,ae,me]=O(M.byName("MessagesConnected",!1),M.byProps("openLazy","hideActionSheet"),M.byName("GuildTooltipActionSheets",!1)),de=u("nsfw_gate_lock"),L=u("img_nitro_star"),R=u("Small"),ue=u("ic_locked_24px"),he=u("ic_full_server_gating_24px"),ge={name:"K2geLocker",version:"1.1.0",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[re];let e="0",t=this.name;d(this.name,"inv_hijack")===void 0&&f(this.name,"inv_hijack",!0);const l=S.after(k,"render",(i,h,g)=>{const w=$(g,c=>{var r,m,y;return((r=c.props)==null?void 0:r.delayLongPress)==300&&((m=c.props)==null?void 0:m.onGuildSelected)===void 0&&((y=c.props)==null?void 0:y.guild)});if(w){S.before(w.type,"type",(c,r,m)=>{d(this.name,r[0].guild.id)?r[0].onGuildSelected=y=>{b.push(U,{guildId:y})}:r[0].onGuildSelected=void 0});return}const v=$(g,c=>{var r,m,y;return((r=c.props)==null?void 0:r.guildId)&&((m=c.props)==null?void 0:m.yPos)&&((y=c.props)==null?void 0:y.onClose)});!v||(S.after(v.type,"render",(c,r,m)=>(d(this.name,r[0].guildId)?m.props.rows=[{icon:he,text:"Unlock Server",onClick:()=>{b.push(U,{guildId:r[0].guildId})}}]:m.props.rows.unshift({icon:ue,text:"Lock Server",onClick:()=>{d(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:R}):d(this.name,r[0].guildId)?a.open({content:"This server is already locked!",source:R}):(f(this.name,r[0].guildId,!0),a.open({content:"Successfully locked!",source:L}))}}),m)),l())});S.instead(me,"default",(i,h,g)=>(e=h[0].guildId,g.apply(i,h))),S.instead(ce,"default",(i,h,g)=>{var w;let v=g.apply(i,h),c=(w=v==null?void 0:v.props)==null?void 0:w.guildId;if(c&&d(this.name,c)){const r=C.createThemedStyleSheet({container:{fontFamily:s.Fonts.PRIMARY_SEMIBOLD,flex:1,alignItems:"center",justifyContent:"center",backgroundColor:s.ThemeColorMap.BACKGROUND_PRIMARY},image:{width:120,height:120,padding:5,marginBottom:30},header:{color:s.ThemeColorMap.HEADER_PRIMARY,fontWeight:"bold",fontSize:25},text:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16},passcode:{width:100,height:20,marginTop:30,borderWidth:1,borderColor:s.ThemeColorMap.HEADER_SECONDARY,backgroundColor:s.ThemeColorMap.HEADER_SECONDARY},footer:{color:s.ThemeColorMap.HEADER_SECONDARY,fontSize:16,marginTop:100,marginBottom:70}});return n.createElement(k,{style:r.container},n.createElement(F,{style:r.image,source:de}),n.createElement(E,{style:r.header},"This server is locked!"),n.createElement(E,{style:r.text},"enter passcode to unlock"),n.createElement(T,{style:r.passcode,onSubmitEditing:m=>{m.nativeEvent.text==_(d(this.name,"passcode"),`${t[0]}${t[1]}${t[4]}`)?(f(this.name,c,!1),a.open({content:"Successfully unlocked!",source:L})):a.open({content:"Incorrect password. Try again.",source:R})},secureTextEntry:!0}),n.createElement(E,{style:r.footer},"K2geLocker"))}else return v}),S.instead(ae,"openLazy",(i,h,g)=>{let w=h[1];(w.startsWith("instant-invite")||w.startsWith("vanity-url-invite"))&&d(this.name,"inv_hijack")?d(this.name,e)?B.show({title:"K2geLocker",body:"This server is locked",confirmText:"Ok"}):B.show({title:"K2geLocker",body:"Select an action",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{d(this.name,"passcode")===void 0?a.open({content:"Please set passcode in plugin setting before you lock the server!",source:R}):(f(this.name,e,!0),a.open({content:"Successfully locked!",source:L}))},onCancel:()=>{g.apply(i,h)}}):g.apply(i,h)})},onStop(){this.commands=[],S.unpatchAll()},getSettingsPanel({settings:e}){return n.createElement(oe,{settings:e})}};j(ge);
