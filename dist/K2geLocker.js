const d=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const r=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const i=window.enmity.modules.common.Toasts,D=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const _=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function P(e){window.enmity.plugins.registerPlugin(e)}const S={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,o)=>window.enmity.modules.filters.byName(e,o),byTypeName:(e,o)=>window.enmity.modules.filters.byTypeName(e,o),byDisplayName:(e,o)=>window.enmity.modules.filters.byDisplayName(e,o)};function K(...e){return window.enmity.modules.bulk(...e)}window.enmity.modules.common;const{components:t}=window.enmity;t.Alert,t.Button,t.FlatList;const U=t.Image;t.ImageBackground,t.KeyboardAvoidingView,t.Modal,t.Pressable,t.RefreshControl,t.ScrollView,t.SectionList,t.StatusBar,t.StyleSheet,t.Switch;const k=t.Text,j=t.TextInput;t.TouchableHighlight,t.TouchableOpacity,t.TouchableWithoutFeedback,t.Touchable;const F=t.View;t.VirtualizedList,t.Form,t.FormArrow,t.FormCTA,t.FormCTAButton,t.FormCardSection,t.FormCheckbox;const G=t.FormDivider;t.FormHint,t.FormIcon;const V=t.FormInput;t.FormLabel,t.FormRadio;const $=t.FormRow,z=t.FormSection;t.FormSelect,t.FormSubLabel;const W=t.FormSwitch;t.FormTernaryCheckBox,t.FormText,t.FormTextColors,t.FormTextSizes;function w(e,o,n){window.enmity.settings.set(e,o,n)}function c(e,o,n){return window.enmity.settings.get(e,o,n)}function Y(e){return window.enmity.patcher.create(e)}function m(e){return window.enmity.assets.getIDByName(e)}function B(e,o){let n="";for(let s=0;s<e.length;s++)n+=String.fromCharCode(e.charCodeAt(s)^o.charCodeAt(s%o.length));return n}const f="Love K2ge3 lol",C=m("img_nitro_star"),H=m("Small");var q=({settings:e})=>r.createElement(F,null,r.createElement(z,{title:"Settings"},r.createElement(V,{value:e.get("passcode"),title:"Passcode",placeholder:"input your custom passcode here!",onSubmitEditing:o=>{if(o.nativeEvent.text=="")i.open({content:"Please enter your custom passcode",source:H});else{let n=B(o.nativeEvent.text,`${f[5]}${f[6]}${f[0]}`);e.set("passcode",n),i.open({content:"Successfully set new passcode!",source:C})}},secureTextEntry:!0}),r.createElement(G,null),r.createElement($,{label:"Enable invitation menu hijacking",trailing:r.createElement(W,{value:e.getBoolean("inv_hijack",!0),onValueChange:o=>{e.set("inv_hijack",o)}})}))),E;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(E||(E={}));var v;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(v||(v={}));var L;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(L||(L={}));var R;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(R||(R={}));var x;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(x||(x={}));var I;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(I||(I={}));const J=m("img_nitro_star"),Q=m("Small"),X={id:"lock",name:"lock",displayName:"lock",description:"Lock the server with passcode",displayDescription:"Lock the server with passcode",type:v.Chat,execute:async function(e,o){c("K2geLocker","passcode")===void 0?i.open({content:"Please set passcode in plugin setting before you lock the server!",source:Q}):(w("K2geLocker",o.guild.id,!0),i.open({content:"Successfully locked!",source:J}))}},g=Y("K2geLocker"),[Z,T,A]=K(S.byName("MessagesConnected",!1),S.byProps("openLazy","hideActionSheet"),S.byName("GuildTooltipActionSheets",!1)),O=m("nsfw_gate_lock"),M=m("img_nitro_star"),b=m("Small"),p={name:"K2geLocker",version:"1.0.2",description:"Lock the specific server with passcode.",authors:[{name:"mafu",id:"519760564755365888"}],onStart(){this.commands=[X];let e="0",o=this.name;c(this.name,"inv_hijack")===void 0&&w(this.name,"inv_hijack",!0),g.instead(A,"default",(n,s,l)=>(e=s[0].guildId,l.apply(n,s))),g.instead(Z,"default",(n,s,l)=>{var a;let h=l.apply(n,s),y=(a=h==null?void 0:h.props)==null?void 0:a.guildId;if(y&&c(this.name,y)){const u=_.createThemedStyleSheet({image:{width:100,height:100,padding:5,marginBottom:15},container:{flex:1,alignItems:"center",justifyContent:"center",backgroundColor:d.ThemeColorMap.BACKGROUND_PRIMARY},header:{color:d.ThemeColorMap.HEADER_PRIMARY,fontFamily:d.Fonts.PRIMARY_SEMIBOLD,fontWeight:"bold",fontSize:24},description:{color:d.ThemeColorMap.HEADER_SECONDARY,fontSize:16,fontFamily:d.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5,marginRight:2.5,marginBottom:70,paddingLeft:25,paddingRight:25,paddingTop:5,textAlign:"center"},passcode:{width:100,height:20,marginTop:50,marginBottom:50,borderBottomWidth:1,borderBottomColor:"#ccc"}});return r.createElement(F,{style:u.container},r.createElement(U,{style:u.image,source:O}),r.createElement(k,{style:u.header},"This server is locked!"),r.createElement(j,{style:u.passcode,onSubmitEditing:N=>{N.nativeEvent.text==B(c(this.name,"passcode"),`${o[0]}${o[1]}${o[4]}`)?(w(this.name,y,!1),i.open({content:"Successfully unlocked!",source:M})):i.open({content:"Incorrect password. Try again.",source:b})},secureTextEntry:!0}),r.createElement(k,{style:u.description},"K2geLocker"))}else return h}),g.instead(T,"openLazy",(n,s,l)=>{let a=s[1];(a.startsWith("instant-invite")||a.startsWith("vanity-url-invite"))&&c(this.name,"inv_hijack")?D.show({title:"K2geLocker",body:"Select an action you wanna perform:",confirmText:"Lock the Server",cancelText:"Open invite menu",onConfirm:()=>{c(this.name,"passcode")===void 0?i.open({content:"Please set passcode in plugin setting before you lock the server!",source:b}):e=="0"?i.open({content:"It seems that plugin failed to get the server. Please select another channel and try again!",source:b}):(w(this.name,e,!0),i.open({content:"Successfully locked!",source:M}))},onCancel:()=>{l.apply(n,s)}}):l.apply(n,s)})},onStop(){this.commands=[],g.unpatchAll()},getSettingsPanel({settings:e}){return r.createElement(q,{settings:e})}};P(p);
